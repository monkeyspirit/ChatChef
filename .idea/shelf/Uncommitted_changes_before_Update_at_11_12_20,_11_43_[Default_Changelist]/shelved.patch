Index: resources/views/recipe_view.blade.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\nuse App\\DataLayer;\n$dl = new \\App\\DataLayer();\n$recipe = $dl->getRecipeByID($id);\n$user = $dl->getUserByID($recipe->user_id);\n\n$ingredients_n = explode(\"_\",$recipe->ingredients_name);\n$ingredients_qu = explode(\"/\",$recipe->ingredients_quantity);\n$ingredients_q = explode(\"_\",$ingredients_qu[0]);\n$ingredients_u = explode(\"_\",$ingredients_qu[1]);\n$number_ing = count($ingredients_n);\n\n$array_ing_en=array(\"1\"=>\"ml\",\"2\"=>\"g\",\"3\"=>\"tbs\",\"4\"=>\"units\", \"5\"=>\"quanto basta\");\n$array_ing_it=array(\"1\"=>\"ml\",\"2\"=>\"g\",\"3\"=>\"cucc.\",\"4\"=>\"unitÃ \", \"5\"=>\"quanto basta\");\n\nfor($i=1; $i<$number_ing; $i++) {\n    if(session()->has('language')){\n        if(session('language')==\"it\"){\n            $ingredients_u[$i] = $array_ing_it[$ingredients_u[$i]];\n        }\n        elseif (session('language')==\"en\"){\n            $ingredients_u[$i] = $array_ing_en[$ingredients_u[$i]];\n        }\n    }\n    else{\n        $ingredients_u[$i] = $array_ing_it[$ingredients_u[$i]];\n    }\n\n}\n\n\n\n$step_text = explode(\"_\",$recipe->steps_text);\n$step_image_id = explode(\"_\",$recipe->steps_image);\n$number_step = count($step_text);\n$step_image = array();\n\nfor($i=1; $i<$number_step; $i++){\n    $path = $dl->getImagePathFromID($step_image_id[$i]);\n    array_push($step_image, $path);\n}\n\n\n\n$array_tag_en = array(\"1\"=>\"First dish\",\"2\" => \"Main\", \"3\" => \"Dessert\", \"4\" => \"Appetizer\", \"5\" => \"Side dish\", \"6\" => \"Meat\", \"7\" => \"Fish\", \"8\" => \"Vegetarian\", \"9\" => \"Vegan\", \"10\" => \"Gluten Free\", \"11\" => \"Without allergens\");\n$array_tag_it = array(\"1\"=>\"Primo\",\"2\" => \"Secondo\", \"3\" => \"Dolce\", \"4\" => \"Antipasto\", \"5\" => \"Contorno\", \"6\" => \"Carne\", \"7\" => \"Pesce\", \"8\" => \"Vegetariano\", \"9\" => \"Vegano\", \"10\" => \"Senza glutine\", \"11\" => \"Senza allergeni\");\n\n$tags = explode(\"_\",$recipe->tags);\n$number_tag = count($tags);\nfor($i=1; $i<$number_tag; $i++) {\n    if(session()->has('language')){\n        if(session('language')==\"it\"){\n            $tags[$i] = $array_tag_it[$tags[$i]];\n        }\n        elseif (session('language')==\"en\"){\n            $tags[$i] = $array_tag_en[$tags[$i]];\n        }\n    }\n    else{\n        $tags[$i] = $array_tag_it[$tags[$i]];\n    }\n\n}\n\n\n$imageCover = $dl->getRecipeCovers($id);\n$number_cover = count($imageCover);\n\n\n\n$list_comment = $dl->getCommentByRecipe($id);\n$number_comment = count($list_comment);\n\n\n//modal form login register\n$users = $dl->getAllUsername();\n\n$n_user = count($users);\n\n\n\n\n$user_logged = -1;\n$istheauthor = false;\n$isAEditor = false;\n$isFav = false;\n$isRewier = false;\n\nif($logged){\n    $isFav = $dl->isFavorite($id, $dl->getUserIDbyUsername($loggedName));\n    $user_logged = $dl->getUserIDbyUsername($loggedName);\n    if($user->id == $user_logged){\n        $istheauthor = true;\n    }\n    $user_role = $dl->getUserbyUsername($loggedName);\n    if($user_role->isEditor){\n        $isAEditor = true;\n    }\n    if($user_role->isModerator && $recipe->approved==0){\n        $isRewier = true;\n    }\n}\n\n$recipes_all = $dl->getAllRecipe();\n\n$recipes = array();\nforeach ($recipes_all as $recipe_ok) {\n    if($recipe_ok->approved == 1 || $recipe_ok->approved == 3){\n        array_push($recipes, $recipe_ok);\n    }\n}\n\n\n?>\n\n@extends('utils.base_page')\n\n@section('title', 'Recipe')\n\n@section('right_navbar')\n    @if($logged)\n        <li class=\"nav-item pr-2 pb-1\">\n            <img style=\"border-radius: 100px; height: 40px; width: 40px;\"\n                 @if(($dl->getUserbyUsername($loggedName))->image_profile == NULL)\n                 src=\"{{asset('image/default_user/paw.jpg')}}\"\n                 @else\n                 src =\"{{asset(($dl->getUserbyUsername($loggedName))->image_profile)}}\"\n                @endif\n            >\n        </li>\n        <li class=\"nav-item\">\n            <div class=\"dropdown\">\n                <button class=\"btn btn-outline-secondary dropdown-toggle \" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                    {{ $loggedName }}\n\n                </button>\n                <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\">\n                    @include('utils.rightnavbar', ['active'=>\"0\"])\n                    <a class=\"dropdown-item\" href=\"{{route('logout')}}\">@lang('labels.logout')</a>\n\n                </div>\n            </div>\n        </li>\n    @else\n\n        <li class=\"nav-item\">\n            <button type=\"button\" class=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#loginRegModal\">\n                @lang('labels.loginButton')\n\n            </button>\n        </li>\n    @endif\n@endsection\n\n@section('body')\n    <div >\n\n\n\n        <!-- Header -->\n        <div class=\"container text-center p-4\">\n            <h1 class=\"h-title\">\n                {{$recipe->title}}\n            </h1>\n            <img src=\"{{asset('image/doodle/doodle-divider.jpg')}}\" width=\"300\" height=\"60\">\n        </div>\n        @if($logged && ($recipe->approved == 1 || $recipe->approved == 3))\n            <div class=\"container pt-5\">\n                <div class=\"justify-content-center\">\n                    <div class=\"text-center pb-5\">\n\n                        @if($isFav)\n                            <button id=\"nofav\" class=\"butt-nofav btn-my btn-outline-my dislike\">\n\n                                <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        @lang('labels.removeFav')\n                                    </div>\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                        <lottie-player id=\"nofav-lottie\"\n                                                       src=\"{{asset('/icons/broken-heart.json')}}\"\n                                                       background=\"transparent\"\n                                                       speed=\"1\"\n                                                       style=\"width: 30px; height: 30px;\"\n                                                       hover\n                                        >\n                                        </lottie-player>\n                                    </div>\n                                </div>\n\n                            </button>\n                            <script>\n                                var nofavanim = document.getElementById(\"nofav-lottie\");\n                                $(\"#nofav\").mouseover(function(){\n                                    nofavanim.play();\n                                });\n\n                                $(\"#nofav\").mouseleave(function(){\n                                    nofavanim.stop();\n                                });\n\n                            </script>\n                        @else\n                            <button id=\"fav\" class=\"butt-fav btn-my btn-outline-my like\">\n\n                                <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        @lang('labels.addFav')\n                                    </div>\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                        <lottie-player id=\"fav-lottie\"\n                                                       src=\"{{asset('/icons/heart-with-arrow.json')}}\"\n                                                       background=\"transparent\"\n                                                       speed=\"1\"\n                                                       style=\"width: 30px; height: 30px;\"\n                                                       hover\n                                        >\n                                        </lottie-player>\n                                    </div>\n                                </div>\n\n                            </button>\n                            <script>\n                                var favanim = document.getElementById(\"fav-lottie\");\n                                $(\"#fav\").mouseover(function(){\n                                    favanim.play();\n                                });\n\n                                $(\"#fav\").mouseleave(function(){\n                                    favanim.stop();\n                                });\n\n                            </script>\n\n\n\n                        @endif\n                            <script>\n                                $(\".like\").click(function (event) {\n                                    event.preventDefault();\n\n                                    $.ajax({\n                                        method: 'POST',\n                                        url: urlFavAdd,\n                                        data: {user_id: {{ $user_logged }}, recipe_id: {{$id}}, _token: token},\n                                        success: function(response){\n                                           window.location.reload();\n\n                                        }\n                                    })\n\n\n                                } );\n                                $(\".dislike\").click(function (event) {\n                                    event.preventDefault();\n                                    $.ajax({\n                                        method: 'POST',\n                                        url: urlFavRemove,\n                                        data: {user_id: {{ $user_logged }}, recipe_id: {{$id}}, _token: token},\n                                        success: function(response){\n                                            window.location.reload();\n\n\n                                        }\n                                    })\n                                } );\n\n\n                            </script>\n\n\n                    </div>\n\n                </div>\n\n\n            </div>\n        @endif\n\n        @if($isRewier)\n            <div class=\"container pb-5\">\n                <div class=\"text-center\">\n                    <label for=\"comment\">@lang('labels.insertCommentAdmin')</label><br/>\n                    <textarea rows=\"3\" class=\"col-md-6\" name=\"comment\" id=\"comment\"></textarea>\n\n                </div>\n                <div class=\"pt-2 row justify-content-around\">\n\n                        <button id=\"accept-button\" class=\"butt-accept btn-my btn-outline-success-my accept\">\n\n                            <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                <div class=\"row justify-content-center align-self-center\">\n                                    @lang('labels.accept')\n                                </div>\n                                <div class=\"row justify-content-center align-self-center\">\n                                    <lottie-player id=\"accept-lottie\"\n                                                   src=\"{{asset('/icons/edit-ok.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 30px; height: 30px;\"\n                                                   hover\n                                    >\n                                    </lottie-player>\n                                </div>\n                            </div>\n\n                        </button>\n                        <script>\n                            var acceptanimation = document.getElementById(\"accept-lottie\");\n\n                            $(\"#accept-button\").mouseover(function () {\n                                acceptanimation.play();\n                            });\n                            $(\"#accept-button\").mouseleave(function () {\n                                acceptanimation.stop();\n                            });\n\n\n                        </script>\n\n\n\n                        <button id=\"decline-button\" class=\"butt-decline btn-my btn-outline-danger-my decline\">\n\n                            <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                <div class=\"row justify-content-center align-self-center\">\n                                  @lang('labels.decline')\n                                </div>\n                                <div class=\"row justify-content-center align-self-center\">\n                                    <lottie-player id=\"decline-lottie\"\n                                                   src=\"{{asset('/icons/edit-cancel.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 30px; height: 30px;\"\n                                                   hover\n                                    >\n                                    </lottie-player>\n                                </div>\n                            </div>\n\n                        </button>\n                        <script>\n                            var declineanimation = document.getElementById(\"decline-lottie\");\n\n                            $(\"#decline-button\").mouseover(function () {\n                                declineanimation.play();\n                            });\n                            $(\"#decline-button\").mouseleave(function () {\n                                declineanimation.stop();\n                            });\n\n\n                        </script>\n\n\n                </div>\n\n            </div>\n            <script>\n                $(\".accept\").click(function (event) {\n                    event.preventDefault();\n\n                    $.ajax({\n                        method: 'POST',\n                        url: urlAccept,\n                        data: {recipe_id: {{$id}}, comment: $('#comment').val(),  _token: token},\n                        success: function(response){\n                            window.location.href = \"{{url('/approved')}}\";\n\n                        }\n                    })\n\n\n                } );\n                $(\".decline\").click(function (event) {\n                    event.preventDefault();\n                    $.ajax({\n                        method: 'POST',\n                        url: urlDecline,\n                        data: {recipe_id: {{$id}},  comment: document.getElementById('comment').value , _token: token},\n                        success: function(response){\n                            window.location.href = \"{{url('/approved')}}\";\n\n\n                        }\n                    })\n                } );\n\n\n            </script>\n\n        @elseif($istheauthor || $isAEditor )\n\n            @if($istheauthor &&  $recipe->approved==2)\n                <div class=\"container\">\n                    <div class=\"row justify-content-center\">\n                        <div class=\"col-md-8 col-sm-12\">\n                            <div class=\"card border-danger text-center\">\n                                <div class=\"card-header text-danger\">\n                                    @lang('labels.viewComment')\n                                </div>\n                                <div class=\"card-body\">\n                                    <p>{{$recipe->comment}}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n            @endif\n\n            <div class=\"container pt-5\">\n                <div class=\"row justify-content-center\">\n                    <div class=\"col-md-8 text-center pb-5\">\n                        @if($recipe->approved!=0)\n                        <a id=\"edit{{$recipe->id}}\" class=\"butt-edit btn-my btn-outline-my\"\n                           href=\"{{route('edit',['id'=>$recipe->id])}}\">\n\n                            <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                <div class=\"row justify-content-center align-self-center\">\n                                    @lang('labels.editTitle')\n                                </div>\n                                <div class=\"row justify-content-center align-self-center\">\n                                    <lottie-player id=\"edit-lottie{{$recipe->id}}\"\n                                                   src=\"{{asset('/icons/edit.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 30px; height: 30px;\"\n                                                   hover\n                                    >\n                                    </lottie-player>\n                                </div>\n\n\n                            </div>\n\n                        </a>\n                        <script>\n                            var editanimation{{$recipe->id}} = document.getElementById(\"edit-lottie{{$recipe->id}}\");\n\n                            $(\"#edit{{$recipe->id}}\").mouseover(function () {\n                                editanimation{{$recipe->id}}.play();\n                            });\n                            $(\"#edit{{$recipe->id}}\").mouseleave(function () {\n                                editanimation{{$recipe->id}}.stop();\n                            });\n\n\n                        </script>\n                        @endif\n\n                    </div>\n                </div>\n            </div>\n\n        @endif\n\n\n\n\n    <!-- Carousel-->\n    <div class=\"container justify-content-center\" style=\"display:flex;\">\n        <div id=\"carouselExampleIndicators\" class=\"carousel slide \" data-ride=\"carousel\" >\n            <ol class=\"carousel-indicators\">\n            <?php\n\n            for($i=0; $i<$number_cover; $i++){\n                if($i==0){\n                    echo '<li data-target=\"#carouselExampleIndicators\" data-slide-to=\"0\" class=\"active\"></li>';\n                }\n                else{\n                    echo ' <li data-target=\"#carouselExampleIndicators\" data-slide-to=\"'.$i.'\"></li>';\n                }\n            }\n            ?>\n            </ol>\n            <div class=\"carousel-inner\">\n                <?php\n\n                for($i=0; $i<$number_cover; $i++){\n                    if($i==0){\n                        echo '<div class=\"carousel-item active \">\n                                    <div class=\"contorno-bianco\">\n                                        <img src=\"'.asset($imageCover[$i]->picture_path).'\" class=\"d-block altezza\" alt=\"...\">\n                                    </div>\n                                    <div class=\"carousel-caption d-none d-md-block\">\n                                        <h5></h5>\n                                    </div>\n                                </div>';\n                    }\n                    else{\n                        echo '<div class=\"carousel-item \">\n                                    <div class=\"contorno-bianco\">\n                                        <img src=\"'.asset($imageCover[$i]->picture_path).'\" class=\"d-block altezza\" alt=\"...\">\n                                    </div>\n                                    <div class=\"carousel-caption d-none d-md-block\">\n                                        <h5></h5>\n                                    </div>\n                                </div>';\n                    }\n                }\n\n                ?>\n\n\n            </div>\n\n            <a class=\"carousel-control-prev\" href=\"#carouselExampleIndicators\" role=\"button\" data-slide=\"prev\">\n                <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n                <span class=\"sr-only\">Previous</span>\n            </a>\n            <a class=\"carousel-control-next\" href=\"#carouselExampleIndicators\" role=\"button\" data-slide=\"next\">\n                <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\n                <span class=\"sr-only\">Next</span>\n            </a>\n        </div>\n    </div>\n\n    <!-- Description -->\n\n    <div class=\"container pt-4 pb-4\">\n        <h3 class=\"h-title text-center\" style=\"font-size: 50px\">\n            @lang('labels.description')\n        </h3>\n        <div class=\"row justify-content-center\">\n            <div class=\"col-md-8 col-sm-12\">\n                <p>{{$recipe->description}}</p>\n            </div>\n        </div>\n\n    </div>\n\n\n        <!-- Informazioni e card-->\n    <div class=\"container pt-3\">\n\n        <div id=\"parent\" class=\"card border-0 pb-3\">\n            <div class=\"row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-lg-3\">\n                <div class=\"col\">\n                    <div class=\"card border-0 mb-3 \">\n                        <div  class=\"card-body\">\n                            <!-- Informazioni autore e data -->\n                            <div class=\"d-flex justify-content-center\">\n                                <div class=\"row  align-self-center pr-4 pb-4\">\n                                    <lottie-player id=\"info-lottie\"\n                                                   src=\"{{asset('/icons/book.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 40px; height: 40px;\"\n\n                                    >\n                                    </lottie-player>\n                                    <script>\n                                        var info_animation = document.getElementById(\"info-lottie\");\n                                        $(\"#parent\").mouseover(function () {\n                                            info_animation.play();\n                                        });\n                                        $(\"#parent\").mouseleave(function () {\n                                            info_animation.stop();\n                                        });\n\n                                    </script>\n\n                                </div>\n\n                                <p class=\"text-center\" style=\"font-family: 'Amatic SC', cursive; font-size: 30px\"> @lang('labels.information') <br></p>\n                            </div>\n                            <p class=\"pl-5\" >@lang('labels.labelCardHome') {{$user->firstname}} {{$user->lastname}}\n                                <img style=\"border-radius: 100px; height: 30px; width: 30px;\"\n                                     @if($user->image_profile == NULL)\n                                     src=\"{{asset('image/default_user/paw.jpg')}}\"\n                                     @else\n                                     src =\"{{asset($user->image_profile)}}\"\n                                    @endif\n                                >\n                            </p>\n                            <p class=\"pl-5\">{{$recipe->date}}</p>\n                            <p class=\"pl-5\">\n                                <?php\n                                for ($i = 1; $i < $number_tag; $i++) {\n                                    echo '<strong>'.$tags[$i].'</strong><br/> ';\n                                }\n                                ?>\n                            </p>\n\n                        </div>\n                    </div>\n                </div>\n                <div class=\"col \">\n\n                    <div class=\"card border-0 mb-3\">\n                        <div class=\"card-body\">\n                            <div class=\"d-flex justify-content-center\">\n                                <div class=\"row  align-self-center pr-4 pb-4\">\n                                    <lottie-player id=\"know-lottie\"\n                                                   src=\"{{asset('/icons/down-arrow.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 40px; height: 40px;\"\n\n                                    >\n                                    </lottie-player>\n                                    <script>\n                                        var know_animation = document.getElementById(\"know-lottie\");\n                                        $(\"#parent\").mouseover(function () {\n                                            know_animation.play();\n                                        });\n                                        $(\"#parent\").mouseleave(function () {\n                                            know_animation.stop();\n                                        });\n\n                                    </script>\n\n                                </div>\n                                <p class=\"text-center\" style=\"font-family: 'Amatic SC', cursive; font-size: 30px\"> @lang('labels.toKnow') <br/>\n                            </div>\n                            <!--Informazioni ricetta -->\n                            <p class=\"pl-5\"><img src=\"{{asset('image/icons_View/recipe-book.png')}}\" class=\"icon\">  @lang('labels.difficult'):\n                                <strong>@if($recipe->difficult == 1) @lang('labels.easy') @elseif($recipe->difficult == 1) @lang('labels.mid') @else @lang('labels.expert') @endif</strong>\n                            </p>\n                            <p class=\"pl-5\"><img src=\"{{asset('image/icons_View/hand_kitchen_mixer_icon.png')}}\" class=\"icon\">  @lang('labels.preptime'):  <strong>{{$recipe->preparation_time}}</strong> min.</p>\n                            <p class=\"pl-5\"><img src=\"{{asset('image/icons_View/kitchen_pot_restaurant_icon.png')}}\" class=\"icon\">   @lang('labels.cookingtime'):   <strong>{{$recipe->cooking_time}}</strong> min.</p>\n                            <p class=\"pl-5\"><img src=\"{{asset('image/icons_View/kitchen_scale_machine_icon.png')}}\" class=\"icon\">  @lang('labels.doses'):  <strong> {{$recipe->doses}}</strong> @lang('labels.people')</p>\n\n                        </div>\n                    </div>\n\n                </div>\n                <div class=\"col \">\n                    <div class=\"card border-0 mb-3\">\n                        <div class=\"card-body \">\n\n                            <div class=\"d-flex justify-content-center\">\n                                <div class=\"row  align-self-center pr-4 pb-4\">\n                                    <lottie-player id=\"ing-lottie\"\n                                                   src=\"{{asset('/icons/list-is-empty.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 35px; height: 35px;\"\n\n                                    >\n                                    </lottie-player>\n                                    <script>\n                                        var ing_animation = document.getElementById(\"ing-lottie\");\n                                        $(\"#parent\").mouseover(function () {\n                                            ing_animation.play();\n                                        });\n                                        $(\"#parent\").mouseleave(function () {\n                                            ing_animation.stop();\n                                        });\n\n                                    </script>\n\n                                </div>\n                                <p class=\"text-center\" style=\"font-family: 'Amatic SC', cursive; font-size: 30px\"> @lang('labels.ingr')</p> <br/>\n                            </div>\n\n                            <!-- Ingredienti -->\n\n                            <p class=\"pl-5\">\n                                @for($i=1; $i<$number_ing; $i++)\n\n                                    - @if($ingredients_u[$i] != \"quanto basta\") {{$ingredients_q[$i]}} @endif {{$ingredients_u[$i]}} @lang('labels.conj') {{$ingredients_n[$i]}} <br/>\n                                @endfor\n                            </p>\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n    </div>\n    <div class=\"container pt-3\">\n\n        <div class=\"container text-center pt-4 pb-4\">\n            <h3 class=\"h-title\" style=\"font-size: 50px\">\n                @lang('labels.method')\n            </h3>\n            <img  src=\"{{asset('image/doodle/doodle-divider2.jpg')}}\" width=\"220\" height=\"20\" alt=\"\">\n        </div>\n        <div class=\"card border-0 \">\n            <div class=\"card-body\">\n\n\n                <!-- card del procedimento, ognuna dotata di immagine -->\n                <div class=\"row row-cols-1 row-cols-sm-2 row-cols-md-2 row-cols-lg-3\">\n\n                    @for($i=1; $i<$number_step; $i++)\n                        <div class=\"col mb-4\">\n                            <div class=\"card\">\n                                <img src=\"{{asset($step_image[$i-1])}}\" class=\"card-img-top\" alt=\"...\">\n                                <div class=\"card-body\">\n                                    <h5 class=\"card-title\">{{$i}}</h5>\n                                    <p class=\"card-text\">{{$step_text[$i]}}</p>\n\n                                </div>\n                            </div>\n                        </div>\n\n                    @endfor\n\n                </div>\n\n            </div>\n        </div>\n    </div>\n\n    @if($logged && $isAEditor && $recipe->approved == 3)\n            <div class=\"container pt-5\">\n                <div class=\"row justify-content-center\">\n                    <div class=\"col-md-6 text-center pb-5\">\n                        <button id=\"correct-button\" class=\"butt-correct btn-my btn-outline-success-my correct\">\n\n                            <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                <div class=\"row justify-content-center align-self-center\">\n                                   @lang('labels.sign')\n                                </div>\n                                <div class=\"row justify-content-center align-self-center\">\n                                    <lottie-player id=\"correct-lottie\"\n                                                   src=\"{{asset('/icons/edit-ok.json')}}\"\n                                                   background=\"transparent\"\n                                                   speed=\"1\"\n                                                   style=\"width: 30px; height: 30px;\"\n                                                   hover\n                                    >\n                                    </lottie-player>\n                                </div>\n                            </div>\n\n                        </button>\n                        <script>\n                            var setcorrectanimation = document.getElementById(\"correct-lottie\");\n\n                            $(\"#correct-button\").mouseover(function () {\n                                setcorrectanimation.play();\n                            });\n                            $(\"#correct-button\").mouseleave(function () {\n                                setcorrectanimation.stop();\n                            });\n\n\n                        </script>\n                        <script>\n                            $(\".correct\").click(function (event) {\n                                event.preventDefault();\n\n                                $.ajax({\n                                    method: 'POST',\n                                    url: urlcorrect,\n                                    data: {recipe_id: {{$id}}, _token: token},\n                                    success: function(response){\n                                        window.location.reload();\n\n                                    }\n                                })\n\n\n                            } );\n                        </script>\n                    </div>\n                </div>\n            </div>\n\n\n    @endif\n\n\n\n\n\n    <div class=\"container text-center pt-4 pb-4\">\n        <h3 class=\"h-title\" style=\"font-size: 50px\">\n            @lang('labels.commentTitle')\n        </h3>\n        <img  src=\"{{asset('image/doodle/doodle-comment.jpg')}}\" width=\"250\" height=\"60\" alt=\"\">\n    </div>\n\n        @if($logged && ($recipe->approved == 1 || $recipe->approved == 3))\n            <div class=\"container pt-5\">\n                <div class=\"justify-content-center\">\n                    {{--<div class=\"col-md-6 text-center pb-5\">\n\n                        @if($isFav)\n                            <button id=\"nofav\" class=\"butt-nofav btn-my btn-outline-my dislike\">\n\n                                <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        @lang('labels.removeFav')\n                                    </div>\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                        <lottie-player id=\"nofav-lottie\"\n                                                       src=\"{{asset('/icons/broken-heart.json')}}\"\n                                                       background=\"transparent\"\n                                                       speed=\"1\"\n                                                       style=\"width: 30px; height: 30px;\"\n                                                       hover\n                                        >\n                                        </lottie-player>\n                                    </div>\n                                </div>\n\n                            </button>\n                            <script>\n                                var nofavanim = document.getElementById(\"nofav-lottie\");\n                                $(\"#nofav\").mouseover(function(){\n                                    nofavanim.play();\n                                });\n\n                                $(\"#nofav\").mouseleave(function(){\n                                    nofavanim.stop();\n                                });\n\n                            </script>\n                        @else\n                            <button id=\"fav\" class=\"butt-fav btn-my btn-outline-my like\">\n\n                                <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        @lang('labels.addFav')\n                                    </div>\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                        <lottie-player id=\"fav-lottie\"\n                                                       src=\"{{asset('/icons/heart-with-arrow.json')}}\"\n                                                       background=\"transparent\"\n                                                       speed=\"1\"\n                                                       style=\"width: 30px; height: 30px;\"\n                                                       hover\n                                        >\n                                        </lottie-player>\n                                    </div>\n                                </div>\n\n                            </button>\n                            <script>\n                                var favanim = document.getElementById(\"fav-lottie\");\n                                $(\"#fav\").mouseover(function(){\n                                    favanim.play();\n                                });\n\n                                $(\"#fav\").mouseleave(function(){\n                                    favanim.stop();\n                                });\n\n                            </script>\n\n\n\n                        @endif\n                            <script>\n                                $(\".like\").click(function (event) {\n                                    event.preventDefault();\n\n                                    $.ajax({\n                                        method: 'POST',\n                                        url: urlFavAdd,\n                                        data: {user_id: {{ $user_logged }}, recipe_id: {{$id}}, _token: token},\n                                        success: function(response){\n                                           window.location.reload();\n\n                                        }\n                                    })\n\n\n                                } );\n                                $(\".dislike\").click(function (event) {\n                                    event.preventDefault();\n                                    $.ajax({\n                                        method: 'POST',\n                                        url: urlFavRemove,\n                                        data: {user_id: {{ $user_logged }}, recipe_id: {{$id}}, _token: token},\n                                        success: function(response){\n                                            window.location.reload();\n\n\n                                        }\n                                    })\n                                } );\n\n\n                            </script>\n\n\n                    </div>--}}\n\n                    @include('utils.modal_comment')\n                    <div class=\"text-center pb-5\">\n                        @if(($dl->getUserbyUsername($loggedName))->ban == 0)\n                            <button id=\"comment\" class=\"butt-comment btn-my btn-outline-my\"  data-toggle=\"modal\" data-target=\"#commentmodal\">\n\n                                <div class=\"d-flex flex-column align-items-start flex-column bd-highlight mb-3 \">\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        @lang('labels.addCommentRecipe')\n                                    </div>\n                                    <div class=\"row justify-content-center align-self-center\">\n                                        <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                        <lottie-player id=\"comment-lottie\"\n                                                       src=\"{{asset('/icons/speech.json')}}\"\n                                                       background=\"transparent\"\n                                                       speed=\"1\"\n                                                       style=\"width: 30px; height: 30px;\"\n                                                       hover\n                                        >\n                                        </lottie-player>\n                                    </div>\n                                </div>\n\n                            </button>\n                            <script>\n                                var commentanim = document.getElementById(\"comment-lottie\");\n                                $(\"#comment\").mouseover(function(){\n                                    commentanim.play();\n                                });\n\n                                $(\"#comment\").mouseleave(function(){\n                                    commentanim.stop();\n                                });\n\n                            </script>\n                        @endif\n\n                    </div>\n\n                </div>\n\n\n            </div>\n    @endif\n\n    <!-- Commenti -->\n    <div class=\"container\">\n        <div class=\"row justify-content-center\">\n            <div class=\"col-sm-12\">\n            @for($i=0; $i<$number_comment; $i++)\n                <?php\n                $user = $list_comment[$i]->user_id;\n                $username = $dl->getUserByID($user)->username;\n                $date = $list_comment[$i]->date;\n                $text =  $list_comment[$i]->text;\n\n                ?>\n\n\n                <div class=\"conteiner pt-3 pb-3\">\n                    <div class=\"card\">\n                        <div class=\"card-body\">\n                            <p class=\"card-text\"><strong>{{$username}}</strong> {{$date}}<br>{{$text}}</p>\n                        </div>\n                    </div>\n                </div>\n\n\n            @endfor\n            </div>\n        </div>\n\n        </div>\n    </div>\n    </div>\n\n    <script>\n        var token = '{{\\Illuminate\\Support\\Facades\\Session::token()}}';\n        var urlFavAdd = '{{route('favoriteAdd')}}';\n        var urlFavRemove = '{{route('favoriteRemove')}}';\n        var urlAccept = '{{route('acceptRecipe')}}';\n        var urlDecline = '{{route('declineRecipe')}}';\n        var urlcorrect = '{{route('correctRecipe')}}';\n    </script>\n\n\n@endsection\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- resources/views/recipe_view.blade.php	(revision cc6d86fd1bc56e00f635b271c8f97d82614052bd)
+++ resources/views/recipe_view.blade.php	(date 1607610667593)
@@ -618,7 +618,7 @@
                             </div>
                             <!--Informazioni ricetta -->
                             <p class="pl-5"><img src="{{asset('image/icons_View/recipe-book.png')}}" class="icon">  @lang('labels.difficult'):
-                                <strong>@if($recipe->difficult == 1) @lang('labels.easy') @elseif($recipe->difficult == 1) @lang('labels.mid') @else @lang('labels.expert') @endif</strong>
+                                <strong>@if($recipe->difficult == 1) @lang('labels.easy') @elseif($recipe->difficult == 2) @lang('labels.mid') @else @lang('labels.expert') @endif</strong>
                             </p>
                             <p class="pl-5"><img src="{{asset('image/icons_View/hand_kitchen_mixer_icon.png')}}" class="icon">  @lang('labels.preptime'):  <strong>{{$recipe->preparation_time}}</strong> min.</p>
                             <p class="pl-5"><img src="{{asset('image/icons_View/kitchen_pot_restaurant_icon.png')}}" class="icon">   @lang('labels.cookingtime'):   <strong>{{$recipe->cooking_time}}</strong> min.</p>
Index: resources/views/insert_recipe.blade.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\nuse App\\DataLayer;\n$dl = new \\App\\DataLayer();\n$user_id = $dl->getUserIDbyUsername( $_SESSION['loggedName']);\n$recipes_all = $dl->getAllRecipe();\n\n$recipes = array();\nforeach ($recipes_all as $recipe_ok) {\n    if($recipe_ok->approved == 1 || $recipe_ok->approved == 3){\n        array_push($recipes, $recipe_ok);\n    }\n}\n\n\n?>\n\n@extends('utils.base_page')\n\n@section('title', 'Insert recipe')\n\n\n@section('right_navbar')\n    <li class=\"nav-item pr-2 pb-1\">\n        <img style=\"border-radius: 100px; height: 40px; width: 40px;\"\n             @if(($dl->getUserbyUsername($loggedName))->image_profile == NULL)\n             src=\"{{asset('image/default_user/paw.jpg')}}\"\n             @else\n             src =\"{{asset(($dl->getUserbyUsername($loggedName))->image_profile)}}\"\n            @endif\n        >\n    </li>\n    <li class=\"nav-item\">\n        <div class=\"dropdown\">\n            <button class=\"btn btn-outline-secondary dropdown-toggle active \" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                {{ $loggedName }}\n            </button>\n            <div class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton\">\n                @include('utils.rightnavbar', ['active'=>\"0\"])\n                <a class=\"dropdown-item\" href=\"{{route('logout')}}\">@lang('labels.logout')</a>\n            </div>\n        </div>\n    </li>\n@endsection\n\n@section('body')\n\n\n    <div class=\"container text-center p-4\">\n        <h1 class=\"h-title\">\n        @lang('labels.insertRecipe')\n    </div>\n\n\n    <div class=\"container pb-5\">\n        <div class=\"tab-content\" id=\"nav-tabContent\">\n            <br/>\n            <div class=\"tab-pane fade show active\" id=\"login\" role=\"tabpanel\" aria-labelledby=\"nav-login-tab\">\n\n                <!-- FORM INSERT RECIPE -->\n\n\n\n                <form id=\"register_form\" action=\"{{route('insert_recipe')}}\" method=\"post\" enctype=\"multipart/form-data\">\n                    @csrf\n\n                    <div class=\"progressbar-container\">\n                        <ul class=\"progressbar\">\n                            <li class=\"step\">@lang('labels.information')</li>\n                            <li class=\"step\">@lang('labels.toKnow')</li>\n                            <li class=\"step\">@lang('labels.ingredient_list')</li>\n                            <li class=\"step\">@lang('labels.method')</li>\n                            <li class=\"step\">@lang('labels.tag')</li>\n                            <li class=\"step\">@lang('labels.save')</li>\n                        </ul>\n                    </div>\n\n                    <br>\n                        <!-- One \"tab\" for each step in the form: -->\n                        <div class=\"col col-lg-8 col-md-10 col-sm-12 card\" style=\"margin: 0 auto; float: none; margin-bottom: 10px;\">\n                            <div class=\"card-body\">\n                                <div class=\"tab\">\n\n\n                                    <div class=\"text-center\">\n                                        <h2>@lang('labels.information')</h2>\n                                    </div>\n                                    <label style=\"color: darkred\">*</label><label><strong>@lang('labels.title'):</strong></label>\n                                    <p><input id=\"title\" name=\"title\" type=\"text\" class=\"form-control\" aria-label=\"Title\" aria-describedby=\"title\"></p>\n                                    <label><strong>@lang('labels.description'):</strong></label>\n                                    <p><textarea rows=\"5\" class=\"form-control\" onkeyup=\"countCharI(this)\" id=\"description\" name=\"description\" aria-label=\"description\" aria-describedby=\"description\"></textarea></p>\n                                    <script>\n                                        function countCharI(val) {\n                                            var len = val.value.length;\n                                            if (len >= 350) {\n                                                $('#charNumI').text(350);\n                                                val.value = val.value.substring(0, 350);\n\n                                            } else {\n                                                $('#charNumI').text(len);\n                                            }\n                                        }\n                                    </script>\n                                    <small id=\"charNumI\">0</small><small>/350</small>\n\n                                    <br>\n                                    <br>\n                                    <label>@lang('labels.insertCover')</label>\n                                    <div id=\"dynamicImage\" class=\"form-row\">\n\n                                    </div>\n\n                                    <br>\n\n                                    <div style=\"text-align: center; border: 0px solid\">\n                                        <button class=\"btn btn-outline-secondary\" id=\"add_form_field2\">@lang('labels.addImage') &nbsp;\n                                            <span style=\"font-size:16px; font-weight:bold;\">+ </span>\n                                        </button>\n                                    </div>\n\n\n\n\n                                    <script>\n                                        $(document).ready(function() {\n                                            var max_fields = 10;\n                                            var wrapper = $(\"#dynamicImage\");\n                                            var add_button = $(\"#add_form_field2\");\n\n                                            var x = 1;\n                                            $(add_button).click(function(e) {\n                                                e.preventDefault();\n                                                if (x < max_fields) {\n                                                    x++;\n\n                                                    $(wrapper).append(' <div id=\"dynamicImage\" class=\"input-group mb-3 pt-2\">\\n'+\n                                                        '<div class=\"custom-file\">\\n'+\n                                                        '<input id=\"file_upload\"  type=\"file\" accept=\"image/*\"  class=\"custom-file-input form-control\" name=\"imageCover[]\" aria-describedby=\"imageCover\">\\n'+\n                                                        '<label class=\"custom-file-label\" for=\"imageCover\">@lang('labels.chooseFile')</label>\\n'+\n                                                        '</div>'+\n                                                        '<a href=\"#\" class=\"delete pt-2 pl-1\" style=\"color: #c72222\"><i class=\"fas fa-minus-square\"></i> @lang('labels.remove')</a></div>'); //add input box\n                                                    $(\".custom-file-input\").on(\"change\", function() {\n                                                        if(this.files[0].size > 2000000){\n                                                            alert(\"File is too big!\");\n                                                            this.value = \"\";\n                                                        }\n                                                        else{\n                                                            var fileName = $(this).val().split(\"\\\\\").pop();\n                                                            $(this).siblings(\".custom-file-label\").addClass(\"selected\").html(fileName);\n\n                                                        }\n\n\n                                                    });\n                                                } else {\n                                                    alert(@lang('labels.reachLimit'))\n                                                }\n                                            });\n\n                                            $(wrapper).on(\"click\", \".delete\", function(e) {\n                                                e.preventDefault();\n                                                $(this).parent('div').remove();\n                                                x--;\n\n                                            })\n                                        });\n                                    </script>\n\n                                </div>\n\n\n                                <div class=\"tab \">\n                                    <br>\n                                    <div class=\"text-center\">\n                                        <h2>@lang('labels.toKnow')</h2>\n                                    </div>\n\n\n                                    </label><label style=\"color: darkred\">*</label><label><img src=\"{{asset('image/icons_View/recipe-book.png')}}\" alt=\"\" class=\"icon\"> <strong>@lang('labels.difficult'):</strong></label>\n                                    <div class=\"custom-control custom-radio\">\n                                        <input type=\"radio\" id=\"customRadio1\" value=\"1\" name=\"difficult\" class=\"custom-control-input\" checked=\"checked\">\n                                        <label class=\"custom-control-label\" for=\"customRadio1\">@lang('labels.easy')</label>\n                                    </div>\n                                    <div class=\"custom-control custom-radio\">\n                                        <input type=\"radio\" id=\"customRadio2\" value=\"2\" name=\"difficult\" class=\"custom-control-input\">\n                                        <label class=\"custom-control-label\" for=\"customRadio2\">@lang('labels.mid')</label>\n                                    </div>\n                                    <div class=\"custom-control custom-radio\">\n                                        <input type=\"radio\" id=\"customRadio3\" value=\"3\" name=\"difficult\" class=\"custom-control-input\">\n                                        <label class=\"custom-control-label\" for=\"customRadio3\">@lang('labels.expert')</label>\n                                    </div>\n\n                                    <br>\n\n                                    <div class=\"row\">\n                                        <div class=\"col-auto\">\n                                            </label><label style=\"color: darkred\">*</label><img src=\"{{asset('image/icons_View/hand_kitchen_mixer_icon.png')}}\" alt=\"\" class=\"icon\">\n                                            <label><strong>@lang('labels.preptime'):</strong>\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <input style=\"width: 150px\" min=0 max=200 name=\"preptime\" id=\"preptime\" type=\"number\"  class=\"form-control\" aria-label=\"Preparation time\" aria-describedby=\"prep\">\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <label>(min.)</label>\n                                        </div>\n                                    </div>\n                                    <br>\n                                    <div class=\"row align-items-center\">\n                                        <div class=\"col-auto\">\n                                            <label style=\"color: darkred\">*</label><img src=\"{{asset('image/icons_View/kitchen_pot_restaurant_icon.png')}}\" alt=\"\"  class=\"icon\">\n                                            <label> <strong>@lang('labels.cookingtime'):</strong></label>\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <input style=\"width: 150px\" min=0 max=200 name=\"cookingtime\" id=\"cookingtime\" type=\"number\" class=\"form-control\" aria-label=\"Cooking time\" aria-describedby=\"cook\">\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <label>(min.)</label>\n                                        </div>\n                                    </div>\n                                    <br>\n                                    <div class=\"row align-items-center\">\n                                        <div class=\"col-auto\">\n                                            <label style=\"color: darkred\">*</label><img src=\"{{asset('image/icons_View/kitchen_scale_machine_icon.png')}}\" alt=\"\"  class=\"icon\">\n                                            <label> <strong>@lang('labels.doses'):</strong></label>\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <input style=\"width: 150px\" min=0 max=200 name=\"doses\" id=\"doses\" type=\"number\" class=\"form-control\" aria-label=\"Doses\" aria-describedby=\"doses\">\n                                        </div>\n                                        <div class=\"col-auto\">\n                                            <label>@lang('labels.people')</label>\n                                        </div>\n\n                                    </div>\n                                    <br>\n\n\n                                    </div>\n\n                                <div class=\"tab\">\n                                    <div class=\"text-center\">\n                                        <h2>@lang('labels.ingredient_list')</h2>\n                                    </div>\n\n                                    <div id=\"dynamicIngredient\" class=\"form-row\">\n                                        <!-- Name -->\n                                        <div class=\"col-auto\">\n                                            <span style=\"color: darkred\"><strong>*</strong></span>\n                                        </div>\n                                        <div class=\"col\">\n                                            <input type=\"text\" class=\"form-control\" placeholder=\"@lang('labels.ingredients')\" name=\"ingredients[0]\">\n                                        </div>\n\n                                        <!-- Quantity -->\n                                        <div class=\"col-auto\">\n                                            <span style=\"color: darkred\"><strong>*</strong></span>\n                                        </div>\n                                        <div class=\"col\">\n                                            <input type=\"number\" step=\"0.01\" min=\"0\" class=\"form-control\" placeholder=\"@lang('labels.quantity')\" name=\"quantities[]\">\n                                        </div>\n\n                                        <!-- Unit -->\n\n                                        <div class=\"col\">\n                                            <select class=\"custom-select\" name=\"units[]\">\n                                                <option value=\"1\" selected>@lang('labels.ml')</option>\n                                                <option value=\"2\">@lang('labels.g')</option>\n                                                <option value=\"3\">@lang('labels.tablespoon')</option>\n                                                <option value=\"4\">@lang('labels.littleunit')</option>\n                                                <option value=\"5\">@lang('labels.qb')</option>\n                                            </select>\n                                        </div>\n                                    </div>\n\n                                    <div id=\"addIng\"></div>\n\n                                    <br/>\n                                    <div class=\"text-center pb-2\">\n                                        <button class=\"btn btn-outline-secondary \" id=\"add_form_field1\">@lang('labels.add_ingredient')\n                                            <span style=\"font-size:16px; font-weight:bold;\">+ </span>\n                                        </button>\n                                    </div>\n\n                                    <script>\n                                        $(document).ready(function() {\n                                            var max_fields = 100;\n                                            var wrapper = $(\"#addIng\");\n                                            var add_button = $(\"#add_form_field1\");\n\n                                            var x = 1;\n                                            $(add_button).click(function(e) {\n                                                e.preventDefault();\n                                                if (x < max_fields) {\n                                                    x++;\n                                                    e = x;\n                                                    $(wrapper).append('<div id=\"dynamicIngredient\" class=\" p-2 form-row\">' +\n                                                        '<!-- Name -->\\n' +\n                                                        '                                    <div class=\"col-auto\">\\n' +\n                                                        '                                            <span style=\"color: darkred\"><strong>*</strong></span>\\n' +\n                                                        '                                        </div>' +\n                                                    '                                        <div class=\"col\">\\n' +\n                                                        '                                        <input oninput=\"this.className = \\'\\'\" type=\"text\" class=\"form-control\" placeholder=@lang('labels.ingredients') name=\"ingredients[]\">\\n' +\n                                                        '                                    </div>\\n' +\n                                                        '\\n' +\n                                                        '                                    <!-- Quantity -->\\n' +\n                                                        '                                    <div class=\"col-auto\">\\n' +\n                                                        '                                            <span style=\"color: darkred\"><strong>*</strong></span>\\n' +\n                                                        '                                        </div><div class=\"col\">\\n' +\n                                                        '                                        <input oninput=\"this.className = \\'\\'\" type=\"number\" step=\"0.01\" min=\"0\" class=\"form-control\" placeholder=@lang('labels.quantity') name=\"quantities[]\">\\n' +\n                                                        '                                    </div>\\n' +\n                                                        '\\n' +\n                                                        '                                    <!-- Unit -->\\n' +\n                                                        '                                    <div class=\"col\">\\n' +\n                                                        '                                        <select class=\"custom-select\" name=\"units[]\">\\n' +\n                                                        '                                            <option value=\"1\" selected>@lang('labels.ml')</option>\\n' +\n                                                        '                                            <option value=\"2\">@lang('labels.g')</option>\\n' +\n                                                        '                                            <option value=\"3\">@lang('labels.tablespoon')</option>\\n'+\n                                                        '                                            <option value=\"4\">@lang('labels.littleunit')</option>'+\n                                                                                                    '<option value=\"5\">@lang('labels.qb')</option>\\n'+\n                                                        '                                        </select></div>\\n' +\n                                                        '                                    <a href=\"#\" class=\"delete pt-2 pl-1\" style=\"color: #c72222\"><i class=\"fas fa-minus-square\"></i> @lang('labels.remove')</a></div>'); //add input box\n\n                                                }\n                                            });\n\n                                            $(wrapper).on(\"click\", \".delete\", function(e) {\n                                                e.preventDefault();\n                                                $(this).parent('div').remove();\n                                                x--;\n\n                                            })\n                                        });\n                                    </script>\n\n                                </div>\n\n                                <div class=\"tab\">\n\n                                    <div class=\"text-center\">\n                                        <h2>@lang('labels.method')</h2>\n                                    </div>\n                                    <label>@lang('labels.insertStep')</label>\n                                    <div id=\"dynamicStepSlot\">\n                                        <label><strong>@lang('labels.step'):</strong></label><label style=\"color: darkred\"> *</label>\n                                        <textarea rows=\"4\" class=\"form-control\" name=\"steps[]\" aria-label=\"steps\" aria-describedby=\"steps\"></textarea>\n                                        <br>\n\n                                       <div class=\"custom-file\">\n                                            <input type=\"file\" accept=\"image/*\" class=\"custom-file-input\" name=\"stepsImage[]\"/>\n                                            <label class=\"custom-file-label\" for=\"stepsImage\">@lang('labels.chooseFile')</label>\n                                        </div>\n\n\n\n\n                                    </div>\n                                    <script>\n                                        $(\".custom-file-input\").on(\"change\", function() {\n                                            var fileName = $(this).val().split(\"\\\\\").pop();\n                                            $(this).siblings(\".custom-file-label\").addClass(\"selected\").html(fileName);\n                                        });\n                                    </script>\n\n\n                                    <br/>\n                                    <div class=\"text-center pb-2\">\n                                        <button class=\"btn btn-outline-secondary \" id=\"add_form_field3\">@lang('labels.addField') &nbsp;\n                                            <span style=\"font-size:16px; font-weight:bold;\">+ </span>\n                                        </button>\n\n                                    </div>\n                                    <script>\n                                        $(document).ready(function() {\n                                            var max_fields = 30;\n                                            var wrapper = $(\"#dynamicStepSlot\");\n                                            var add_button = $(\"#add_form_field3\");\n\n                                            var x = 1;\n                                            $(add_button).click(function(e) {\n                                                e.preventDefault();\n                                                if (x < max_fields) {\n                                                    x++;\n\n                                                    $(wrapper).append('<div id=\"dynamicStepSlot\">'+\n                                                                            '<br><label><strong>@lang('labels.step'):</strong></label><label style=\"color: darkred\"> *</label>\\n' +\n                                                        '                                        <textarea rows=\"4\" class=\"form-control\" name=\"steps[]\" aria-label=\"steps\" aria-describedby=\"steps\"></textarea>\\n' +\n                                                        '                                        <br>\\n' +\n\n                                                        '                                           <div class=\"custom-file\">\\n' +\n                                                        '                                            <input type=\"file\" accept=\"image/*\" class=\"custom-file-input\" name=\"stepsImage[]\"/>\\n' +\n                                                        '                                            <label class=\"custom-file-label\" for=\"stepsImage\">@lang(\"labels.chooseFile\")</label>\\n' +\n                                                        '                                        </div>' +\n                                                        '           <a href=\"#\" class=\"delete pt-2 pl-1\" style=\"color: #c72222\"><i class=\"fas fa-minus-square\"></i> @lang(\"labels.remove\")</a></div>'); //add input box\n                                                    $(\".custom-file-input\").on(\"change\", function() {\n                                                        var fileName = $(this).val().split(\"\\\\\").pop();\n                                                        $(this).siblings(\".custom-file-label\").addClass(\"selected\").html(fileName);\n                                                    });\n\n\n                                                }\n                                            });\n\n                                            $(wrapper).on(\"click\", \".delete\", function(e) {\n                                                e.preventDefault();\n                                                $(this).parent('div').remove();\n                                                x--;\n\n                                            })\n                                        });\n                                    </script>\n\n                                </div>\n\n                                <div class=\"tab\">\n                                    <div class=\"text-center\">\n                                        <h2>@lang('labels.tags')</h2>\n                                    </div>\n                                    <label>@lang('labels.inserTag')</label>\n                                    <div id=\"dynamicTags\" class=\"col-sm-12 text-center\">\n                                        <select class=\"custom-select\" name=\"tags[]\">\n                                            <option value=\"1\" selected>@lang('labels.firstDish')</option>\n                                            <option value=\"2\">@lang('labels.mainCourse')</option>\n                                            <option value=\"3\">@lang('labels.dessert')</option>\n                                            <option value=\"4\">@lang('labels.appetiser')</option>\n                                            <option value=\"5\">@lang('labels.sideDish')</option>\n                                            <option value=\"6\">@lang('labels.meat')</option>\n                                            <option value=\"7\">@lang('labels.fish')</option>\n                                            <option value=\"8\">@lang('labels.vegetarian')</option>\n                                            <option value=\"9\">@lang('labels.vegan')</option>\n                                            <option value=\"10\">@lang('labels.glutenFree')</option>\n                                            <option value=\"11\">@lang('labels.withoutAll')</option>\n                                        </select>\n                                    </div>\n\n                                    <br/>\n                                    <div class=\"text-center pb-2\">\n                                        <button class=\"btn btn-outline-secondary \" id=\"add_form_field4\">@lang('labels.addField') &nbsp;\n                                            <span style=\"font-size:16px; font-weight:bold;\">+ </span>\n                                        </button>\n\n                                    </div>\n\n                                    <script>\n                                        $(document).ready(function() {\n                                            var max_fields = 30;\n                                            var wrapper = $(\"#dynamicTags\");\n                                            var add_button = $(\"#add_form_field4\");\n\n                                            var x = 1;\n\n                                            $(add_button).click(function(e) {\n                                                e.preventDefault();\n                                                if (x < max_fields) {\n                                                    x++;\n\n                                                    $(wrapper).append('<div id=\"dynamicTags\" class=\"input-group col-sm-12 text-center p-2\">' +\n                                                        '<select class=\"custom-select\" name=\"tags[]\">'+\n                                                        '<option value=\"1\" selected>@lang('labels.firstDish')</option>'+\n                                                        '<option value=\"2\">@lang('labels.mainCourse')</option>'+\n                                                        '<option value=\"3\">@lang('labels.dessert')</option>'+\n                                                        '<option value=\"4\">@lang('labels.appetiser')</option>' +\n                                                        '<option value=\"5\">@lang('labels.sideDish')</option>'+\n                                                        '<option value=\"6\">@lang('labels.meat')</option>'+\n                                                        '<option value=\"7\">@lang('labels.fish')</option>'+\n                                                        '<option value=\"8\">@lang('labels.vegetarian')</option>'+\n                                                        '<option value=\"9\">@lang('labels.vegan')</option>'+\n                                                        '<option value=\"10\">@lang('labels.glutenFree')</option>'+\n                                                        '<option value=\"11\">@lang('labels.withoutAll')</option>'+\n                                                        '</select>'+\n\n                                                        '<a href=\"#\" class=\"delete pt-2 pl-1\" style=\"color: #c72222\"><i class=\"fas fa-minus-square\"></i> @lang('labels.remove')</a></div>'); //add input box\n                                                }\n                                            });\n\n                                            $(wrapper).on(\"click\", \".delete\", function(e) {\n                                                e.preventDefault();\n                                                $(this).parent('div').remove();\n                                                x--;\n\n                                            })\n                                        });\n\n                                    </script>\n\n                                    <br/>\n\n                                </div>\n\n                                <div class=\"tab\">\n                                    <div class=\"container\">\n                                        <div class=\"text-center\">\n                                            <h2>@lang('labels.success')!</h2>\n                                        </div>\n                                        <label class=\"text-center\">@lang('labels.save_text')</label>\n                                        <div class=\"row justify-content-center\">\n                                            <script src=\"https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js\"></script>\n                                            <lottie-player src=\"https://assets10.lottiefiles.com/private_files/lf30_womtqnns.json\"  background=\"transparent\"  speed=\"1\"  style=\"width: 300px; height: 300px;\"  loop  autoplay></lottie-player>\n                                        </div>\n                                    </div>\n\n\n\n                                </div>\n                                <div  class=\"text-center\">\n                                    <div class=\"pt-3  \">\n                                        <input style=\"width: auto\" type=\"submit\" id=\"submit\" name=\"register_form\" class=\"form-control btn btn-success\" value=@lang('labels.save')>\n                                    </div>\n                                </div>\n                                <div class=\"text-center\">\n                                    <div class=\"pt-3\">\n                                       {{-- <a type=\"button\" class=\"btn btn-danger\" href=\"{{route(\"account_all_recipes\")}}\">@lang('labels.cancel')</a>--}}\n\n                                            <button type=\"button\" class=\"btn btn-outline-secondary\" id=\"prevBtn\" onclick=\"nextPrev(-1)\">@lang('labels.prev')</button>\n\n                                            <button type=\"button\" class=\"btn btn-outline-primary\" id=\"nextBtn\" onclick=\"nextPrev(1)\">@lang('labels.next')</button>\n\n\n                                    </div>\n                                </div>\n\n                            </div>\n                        </div>\n\n\n\n                    <script>\n                        var currentTab = 0; // Current tab is set to be the first tab (0)\n                        showTab(currentTab); // Display the current tab\n\n                        function showTab(n) {\n                            // This function will display the specified tab of the form ...\n                            var x = document.getElementsByClassName(\"tab\");\n                            x[n].style.display = \"block\";\n                            // ... and fix the Previous/Next buttons:\n                            if (n == 0) {\n                                document.getElementById(\"prevBtn\").style.display = \"none\";\n                            } else {\n                                document.getElementById(\"prevBtn\").style.display = \"inline\";\n                            }\n                            if (n == (x.length - 1)) {\n\n                                document.getElementById(\"nextBtn\").style.display = \"none\";\n                                document.getElementById(\"submit\").style.display = \"inline\";\n                            } else {\n\n                                document.getElementById(\"nextBtn\").style.display = \"inline\";\n                                document.getElementById(\"submit\").style.display = \"none\";\n                            }\n                            // ... and run a function that displays the correct step indicator:\n                            fixStepIndicator(n)\n                        }\n\n                        function nextPrev(n) {\n                            // This function will figure out which tab to display\n                            var x = document.getElementsByClassName(\"tab\");\n                            // Exit the function if any field in the current tab is invalid:\n                            if (n == 1 && !validateForm()) return false;\n                            // Hide the current tab:\n                            x[currentTab].style.display = \"none\";\n                            // Increase or decrease the current tab by 1:\n                            currentTab = currentTab + n;\n                            // if you have reached the end of the form... :\n                            if (currentTab >= x.length) {\n                                //...the form gets submitted:\n                                document.getElementById(\"regForm\").submit();\n                                return false;\n                            }\n                            // Otherwise, display the correct tab:\n                            showTab(currentTab);\n                        }\n\n                        function validateForm() {\n                            // This function deals with validation of the form fields\n                            var x, y, i, z, valid = true;\n                            x = document.getElementsByClassName(\"tab\");\n                            y = x[currentTab].getElementsByTagName(\"input\");\n                            z = x[currentTab].getElementsByTagName(\"textarea\");\n\n                            // A loop that checks every input field in the current tab:\n                            for (i = 0; i < y.length; i++) {\n                                // If a field is empty...\n                                if (y[i].value === \"\" && y[i].type !== \"file\") {\n                                    // add an \"invalid\" class to the field:\n                                    y[i].className += \" invalid\";\n                                    // and set the current valid status to false:\n                                    valid = false;\n                                }\n\n                                if (y[i].type === \"checkbox\"){\n                                    if (y[i].checked){\n                                        y[i].value = \"1\";\n                                    }\n                                    else{\n                                        y[i].checked = true;\n                                        y[i].value = \"0\";\n                                    }\n                                }\n\n                                if (y[i].type === \"file\") {\n                                    if (y[i].value === \"\") {\n\n                                    }\n                                }\n\n                            }\n\n                            for (i = 0; i < z.length; i++) {\n                                // If a field is empty...\n                                if (z[i].value === \"\" && z[i].name !== \"description\") {\n                                    // add an \"invalid\" class to the field:\n                                    z[i].className += \" invalid\";\n                                    // and set the current valid status to false:\n                                    valid = false;\n                                }\n                            }\n                            // If the valid status is true, mark the step as finished and valid:\n                            if (valid) {\n                                document.getElementsByClassName(\"step\")[currentTab].className += \" finish\";\n                            }\n                            return valid; // return the valid status\n                        }\n\n                        function fixStepIndicator(n) {\n                            // This function removes the \"active\" class of all steps...\n                            var i, x = document.getElementsByClassName(\"step\");\n                            for (i = 0; i < x.length; i++) {\n                                x[i].className = x[i].className.replace(\" active\", \"\");\n                                x[i].className = x[i].className.replace(\" focus\", \"\");\n                            }\n                            //... and adds the \"active\" class to the current step:\n\n                            for (i = 0; i < n-1; i++) {\n                                x[i].className  += \" active\";\n                            }\n\n                            x[n-1].className += \" active\";\n                            x[n].className += \" focus\";\n                        }\n\n\n\n                    </script>\n                </form>\n\n\n            </div>\n\n        </div>\n    </div>\n\n\n\n@endsection\n\n\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- resources/views/insert_recipe.blade.php	(revision cc6d86fd1bc56e00f635b271c8f97d82614052bd)
+++ resources/views/insert_recipe.blade.php	(date 1607683422819)
@@ -297,14 +297,14 @@
                                                         '                                            <span style="color: darkred"><strong>*</strong></span>\n' +
                                                         '                                        </div>' +
                                                     '                                        <div class="col">\n' +
-                                                        '                                        <input oninput="this.className = \'\'" type="text" class="form-control" placeholder=@lang('labels.ingredients') name="ingredients[]">\n' +
+                                                        '                                        <input type="text" class="form-control" placeholder=@lang('labels.ingredients') name="ingredients[]">\n' +
                                                         '                                    </div>\n' +
                                                         '\n' +
                                                         '                                    <!-- Quantity -->\n' +
                                                         '                                    <div class="col-auto">\n' +
                                                         '                                            <span style="color: darkred"><strong>*</strong></span>\n' +
                                                         '                                        </div><div class="col">\n' +
-                                                        '                                        <input oninput="this.className = \'\'" type="number" step="0.01" min="0" class="form-control" placeholder=@lang('labels.quantity') name="quantities[]">\n' +
+                                                        '                                        <input type="number" step="0.01" min="0" class="form-control" placeholder=@lang('labels.quantity') name="quantities[]">\n' +
                                                         '                                    </div>\n' +
                                                         '\n' +
                                                         '                                    <!-- Unit -->\n' +
Index: app/Http/Controllers/RecipeController.php
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\DataLayer;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Redirect;\nuse Illuminate\\Support\\Facades\\Storage;\nuse phpDocumentor\\Reflection\\Types\\Null_;\n\nclass RecipeController extends Controller\n{\n    public function addRecipe(){\n\n          if (isset($_POST['register_form'])){\n\n            $title = $_POST['title'];\n            $date = date(\"Y/m/d\");\n            $difficult = $_POST['difficult'];\n            $preptime = $_POST['preptime'];\n            $cookingtime = $_POST['cookingtime'];\n            $doses = $_POST['doses'];\n            $description = $_POST['description'];\n\n            $count_ing = sizeof($_POST['ingredients']);\n            $ingredients_name = \"\";\n            $ingredients_quantity = \"\";\n            for($i=0; $i<$count_ing; $i++){\n                $ingredients_name = $ingredients_name.\"_\".$_POST['ingredients'][$i];\n                $ingredients_quantity = $ingredients_quantity.\"_\".$_POST['quantities'][$i];\n            }\n            $ingredients_quantity = $ingredients_quantity.\"/\";\n            for( $n=0; $n<$count_ing; $n++) {\n                $ingredients_quantity = $ingredients_quantity.\"_\".$_POST['units'][$n];\n            }\n\n            $count_step= sizeof($_POST['steps']);\n            $step_text=\"\";\n            for($k=0; $k<$count_step; $k++){\n                $step_text = $step_text.\"_\".$_POST['steps'][$k];\n            }\n\n            $step_images=\"prova\";\n\n\n\n            $count_tag= sizeof($_POST['tags']);\n            $tags=\"\";\n            for($l=0; $l<$count_tag; $l++){\n                $tags = $tags.\"_\".$_POST['tags'][$l];\n            }\n\n        }\n\n        session_start();\n        $dl = new DataLayer();\n\n        $user_id = $dl->getUserIDbyUsername($_SESSION['loggedName']);\n        $recipe = array('title'=>$title, 'description'=>$description, 'preparation_time'=> $preptime, 'cooking_time'=>$cookingtime, 'difficult'=> $difficult, 'doses'=> $doses, 'user_id'=>$user_id,'date'=>$date, 'ingredients_name'=>$ingredients_name, 'ingredients_quantity'=>$ingredients_quantity, 'steps_text'=>$step_text, 'steps_image'=>$step_images,'tags'=> $tags, 'approved'=>0, 'comment'=>NULL);\n\n        $dl->addRecipeDB($recipe);\n        $recipe_id = $dl->getLastRecipeUserInsert($user_id);\n\n        if (isset($_FILES['stepsImage'])){\n\n\n            $path='upload/'. $recipe_id.'/';\n            mkdir($path,0777,true);\n            $step_images=\"\";\n\n            for($t=0; $t<$count_step; $t++){\n                if($_FILES['stepsImage']['type'][$t] !== \"\"){\n\n                    move_uploaded_file($_FILES['stepsImage']['tmp_name'][$t], $path . $_FILES['stepsImage']['name'][$t]);\n                    $image = array('picture_path'=>$path . $_FILES['stepsImage']['name'][$t],'recipe_id'=>null);\n                    $dl->addImageRecipe($image);\n                    $image_id = $dl->getLastImageInsert($path . $_FILES['stepsImage']['name'][$t]);\n                    $step_images = $step_images.\"_\".$image_id;\n                }\n                else{\n\n                    $n= rand(1, 6);\n                    $default_path = 'image/default_step_image/'.$n.'.jpg';\n                    $image = array('picture_path'=>$default_path,'recipe_id'=>null);\n                    $dl->addImageRecipe($image);\n                    $image_id = $dl->getLastImageInsert($default_path . $_FILES['stepsImage']['name'][$t]);\n                    $step_images = $step_images.\"_\".$image_id;\n\n                }\n\n\n            }\n\n            $dl->updateImageRecipeSteps($recipe_id,$step_images);\n        }\n\n\n        if (isset($_FILES['imageCover'])) {\n            $imgCover = count($_FILES['imageCover']['name']);\n\n            $pathCover = 'upload_cover/' . $recipe_id . '/';\n            mkdir($pathCover, 0777, true);\n\n            for ($t = 0; $t < $imgCover; $t++) {\n\n                if($_FILES['imageCover']['type'][$t] !== \"\"){\n                    move_uploaded_file($_FILES['imageCover']['tmp_name'][$t], $pathCover . $_FILES['imageCover']['name'][$t]);\n                    $image = array('picture_path' => $pathCover . $_FILES['imageCover']['name'][$t], 'recipe_id' => $recipe_id);\n                    $dl->addImageRecipe($image);\n                }\n                else{\n                    $path_default = 'image/default_cover.jpg';\n                    $image = array('picture_path' => $path_default, 'recipe_id' => $recipe_id);\n                    $dl->addImageRecipe($image);\n                }\n\n            }\n        }\n        else{\n            $path_default = 'image/default_cover.jpg';\n\n            $image = array('picture_path' => $path_default, 'recipe_id' => $recipe_id);\n            $dl->addImageRecipe($image);\n\n        }\n\n       return Redirect::to(route('account_all_recipes'));\n\n    }\n\n    public function editRecipe($id){\n\n        session_start();\n        $dl = new DataLayer();\n        $rec = $dl->getRecipeByID($id);\n\n        if(isset($_SESSION['logged'])) {\n\n            $user = $dl->getUserbyUsername($_SESSION['loggedName']);\n            if ($user->isModerator || $user->id == $rec->user_id) {\n                if (isset($_POST['edit_form'])) {\n\n\n                    $title = $_POST['title_edit'];\n                    $difficult = $_POST['difficult_edit'];\n                    $preptime = $_POST['preptime_edit'];\n                    $cookingtime = $_POST['cookingtime_edit'];\n                    $doses = $_POST['doses_edit'];\n                    $description = $_POST['description_edit'];\n\n                    $count_ing = sizeof($_POST['ingredients_edit']);\n                    $ingredients_name = \"\";\n                    $ingredients_quantity = \"\";\n\n\n                    for ($i = 0; $i < $count_ing; $i++) {\n                        $ingredients_name = $ingredients_name . \"_\" . $_POST['ingredients_edit'][$i];\n                        $ingredients_quantity = $ingredients_quantity . \"_\" . $_POST['quantities_edit'][$i];\n                    }\n                    $ingredients_quantity = $ingredients_quantity . \"/\";\n                    for ($n = 0; $n < $count_ing; $n++) {\n                        $ingredients_quantity = $ingredients_quantity . \"_\" . $_POST['units_edit'][$n];\n                    }\n\n\n                    $count_step = sizeof($_POST['steps_edit']);\n                    $step_text = \"\";\n                    for ($k = 0; $k < $count_step; $k++) {\n                        $step_text = $step_text . \"_\" . $_POST['steps_edit'][$k];\n                    }\n\n\n                    if (isset($_FILES['stepsImage_edit'])) {\n                        $t = 0;\n                        $new_step = \"\";\n\n                        //Creo il path per le nuove foto\n                        $path = 'upload/' . $id . '/';\n                        //Nuove da sostituire o aggiungere\n                        $img = count($_FILES['stepsImage_edit']['type']);\n\n                        if ($_POST['todeleteStepImage'] != null) {\n\n                            //Da eliminare\n                            $todelete = explode(\"_\", $_POST['todeleteStepImage']);\n                            for ($i = 0; $i < count($todelete) - 1; $i++) {\n                                $todelete[$i] = $todelete[$i + 1];\n                            }\n\n                            //array contenente gli indici da eliminare\n                            $withoutCopies = array_unique($todelete);\n\n                            //recupero gli step giÃ  presenti\n                            $old_steps_text = $dl->getStepImages($id);\n                            $old_step = explode(\"_\", $old_steps_text);\n                            unset($old_step[0]);\n\n                            for ($i = 0; $i < count($withoutCopies); $i++) {\n                                $j = $withoutCopies[$i];\n                                $dl->deleteImage($old_step[$j]);\n                                $old_step[$j] = -1;\n                            }\n\n                            $old_step = array_values($old_step);\n\n                            for ($i = 0; $i < count($old_step); $i++) {\n                                if ($old_step[$i] == -1) {\n\n                                    if($_FILES['stepsImage_edit']['type'][$t] !== \"\"){\n                                        move_uploaded_file($_FILES['stepsImage_edit']['tmp_name'][$t], $path . $_FILES['stepsImage_edit']['name'][$t]);\n                                        $image = array('picture_path' => $path . $_FILES['stepsImage_edit']['name'][$t], 'recipe_id' => null);\n                                        $dl->addImageRecipe($image);\n                                        $image_id = $dl->getLastImageInsert($path . $_FILES['stepsImage_edit']['name'][$t]);\n                                        $old_step[$i] = $image_id;\n                                        $t++;\n                                    }\n                                    else{\n                                        $n= rand(1, 6);\n                                        $default_path = 'image/default_step_image/'.$n.'.jpg';\n                                        $image = array('picture_path' => $default_path, 'recipe_id' => null);\n                                        $dl->addImageRecipe($image);\n                                        $image_id = $dl->getLastImageInsert($default_path . $_FILES['stepsImage_edit']['name'][$t]);\n                                        $old_step[$i] = $image_id;\n                                        $t++;\n                                    }\n\n\n\n                                }\n\n\n                            }\n\n\n                            if (count($old_step) == 0) {\n                                $new_step = $new_step . '_';\n                            } else {\n                                for ($i = 0; $i < count($old_step); $i++) {\n                                    $new_step = $new_step . '_' . $old_step[$i];\n                                }\n                            }\n                        } else {\n\n                            $new_step = $dl->getStepImages($id);\n                        }\n\n\n                        for ($k = $t; $k < $img; $k++) {\n                            if($_FILES['stepsImage_edit']['type'][$k] !== \"\"){\n                                move_uploaded_file($_FILES['stepsImage_edit']['tmp_name'][$k], $path . $_FILES['stepsImage_edit']['name'][$k]);\n                                $image = array('picture_path' => $path . $_FILES['stepsImage_edit']['name'][$k], 'recipe_id' => null);\n                                $dl->addImageRecipe($image);\n                                $image_id = $dl->getLastImageInsert($path . $_FILES['stepsImage_edit']['name'][$k]);\n                                $new_step = $new_step . '_' . $image_id;\n                            }\n                            else {\n                                $n= rand(1, 6);\n                                $default_path = 'image/default_step_image/'.$n.'.jpg';\n                                $image = array('picture_path'=>$default_path,'recipe_id'=>null);\n                                $dl->addImageRecipe($image);\n                                $image_id = $dl->getLastImageInsert($default_path . $_FILES['stepsImage_edit']['name'][$k]);\n                                $new_step = $new_step.\"_\".$image_id;\n                            }\n\n                        }\n\n\n                        $dl->updateImageRecipeSteps($id, $new_step);\n\n\n                    } else {\n\n                        if ($_POST['todeleteStepImage'] != null) {\n\n                            $new_step = \"\";\n                            //Da eliminare\n                            $todelete = explode(\"_\", $_POST['todeleteStepImage']);\n                            for ($i = 0; $i < count($todelete) - 1; $i++) {\n                                $todelete[$i] = $todelete[$i + 1];\n                            }\n\n\n                            //array contenente gli indici da eliminare\n                            $withoutCopies = array_unique($todelete);\n\n\n                            //recupero gli step giÃ  presenti\n                            $old_steps_text = $dl->getStepImages($id);\n                            $old_step = explode(\"_\", $old_steps_text);\n\n                            unset($old_step[0]);\n\n\n                            for ($i = 0; $i < count($withoutCopies); $i++) {\n                                $j = $withoutCopies[$i];\n                                unset($old_step[$j]);\n                            }\n\n\n                            $old_step = array_values($old_step);\n\n                            echo \"<pre>\", print_r($old_step), \"</pre>\";\n\n\n                            if (count($old_step) == 0) {\n                                $new_step = $new_step . '_';\n                            } else {\n                                for ($i = 0; $i < count($old_step); $i++) {\n                                    $new_step = $new_step . '_' . $old_step[$i];\n                                }\n                            }\n\n                            $dl->updateImageRecipeSteps($id, $new_step);\n                        }\n\n\n                    }\n\n\n                    $count_tag = sizeof($_POST['tags_edit']);\n                    $tags = \"\";\n                    for ($l = 0; $l < $count_tag; $l++) {\n                        $tags = $tags . \"_\" . $_POST['tags_edit'][$l];\n                    }\n\n                }\n\n\n                $approved = 0;\n\n                $dl->updateRecipe($title, $description, $preptime, $cookingtime, $difficult, $doses, $ingredients_name, $ingredients_quantity, $step_text, $tags, $id, $approved, NULL);\n\n\n                if ($_POST['todeleteCover'] != null) {\n\n                    $todeleteCover = explode(\"_\", $_POST['todeleteCover']);\n                    for ($i = 0; $i < count($todeleteCover) - 1; $i++) {\n                        $todeleteCover[$i] = $todeleteCover[$i + 1];\n                    }\n\n                    $oldcovers = $dl->getRecipeCovers($id);\n\n                    for ($i = 0; $i < count($oldcovers); $i++) {\n                        for ($j = 0; $j < count($todeleteCover); $j++) {\n\n                            if ($i == ($todeleteCover[$j])) {\n                                $dl->deleteImage($oldcovers[$i]->id);\n                            }\n\n                        }\n\n                    }\n                }\n\n\n                if (isset($_FILES['imageCover_edit'])) {\n\n                    $imgCover = count($_FILES['imageCover_edit']['name']);\n\n                    $pathCover = 'upload_cover/' . $id . '/';\n\n                    for ($t = 0; $t < $imgCover; $t++) {\n                        if($_FILES['imageCover_edit']['type'][$t] !== \"\"){\n                            move_uploaded_file($_FILES['imageCover_edit']['tmp_name'][$t], $pathCover . $_FILES['imageCover_edit']['name'][$t]);\n                            $image = array('picture_path' => $pathCover . $_FILES['imageCover_edit']['name'][$t], 'recipe_id' => $id);\n                            $dl->addImageRecipe($image);\n                        }\n                        else {\n                            $path_default = 'image/default_cover.jpg';\n                            $image = array('picture_path' => $path_default, 'recipe_id' => $id);\n                            $dl->addImageRecipe($image);\n                        }\n\n                    }\n\n                }\n\n\n                return Redirect::to(route('account_all_recipes'));\n\n            }\n            else{\n                return view('error_view')->with('logged',true)->with('loggedName', $_SESSION['loggedName']);\n            }\n        }\n        else{\n            return view('error_view')->with('logged',false);\n        }\n\n    }\n\n    public function addFavorite(Request $request){\n        $user_id = $request['user_id'];\n        $recipe_id = $request['recipe_id'];\n\n        session_start();\n        $dl = new DataLayer();\n\n        $dl->addToFavorites($recipe_id,$user_id);\n        return null;\n    }\n\n\n    public function removeFavorite(Request $request){\n        $user_id = $request['user_id'];\n        $recipe_id = $request['recipe_id'];\n\n        session_start();\n        $dl = new DataLayer();\n\n        $dl->removeFromFavorites($recipe_id,$user_id);\n        return null;\n    }\n\n    public function deleteRecipe($id){\n        session_start();\n        $dl = new DataLayer();\n        $rec = $dl->getRecipeByID($id);\n\n        if(isset($_SESSION['logged'])) {\n\n            $user = $dl->getUserbyUsername($_SESSION['loggedName']);\n            if ($user->id == $rec->user_id) {\n                $dl->removeRecipe($id);\n                return Redirect::to(route('account_all_recipes'));\n            }\n            else{\n                return view('error_view')->with('logged',true)->with('loggedName', $_SESSION['loggedName']);\n\n            }\n        }\n        else {\n            return view('error_view')->with('logged',false);\n        }\n\n    }\n\n    public function getSearchType($type){\n        session_start();\n        $dl = new DataLayer();\n\n\n        $recipes_all = $dl->getAllRecipe();\n\n        $result = array();\n\n        $recipes = array();\n        foreach ($recipes_all as $recipe_ok) {\n            if($recipe_ok->approved == 1 || $recipe_ok->approved == 3){\n                array_push($recipes, $recipe_ok);\n            }\n        }\n\n        foreach ($recipes as $recipe){\n            $recipe_tag = $recipe->tags;\n            $explode_tag = explode(\"_\", $recipe_tag);\n            array_shift($explode_tag);\n\n            if(in_array($type,$explode_tag)){\n                array_push($result,$recipe->id);\n            }\n        }\n\n        echo \"<pre>\", print_r($result), \"</pre>\";\n\n\n\n        return Redirect::to(route('search_advanced_get',['array'=>json_encode($result)]));\n\n    }\n\n    public function getSearchResult(Request $request){\n        session_start();\n        $dl = new DataLayer();\n\n        $id_recipes_ok = array();\n        $recipes_all = $dl->getAllRecipe();\n\n        $recipes = array();\n        foreach ($recipes_all as $recipe_ok) {\n            if($recipe_ok->approved == 1 || $recipe_ok->approved == 3){\n                array_push($recipes, $recipe_ok);\n            }\n        }\n\n        foreach ($recipes as $recipe) {\n\n            $toBeAdded = true;\n\n            if (!$request->has('easy') && $recipe->difficult == 1) {\n                $toBeAdded = false;\n            } else if (!$request->has('medium') && $recipe->difficult == 2) {\n                $toBeAdded = false;\n            } else if (!$request->has('hard') && $recipe->difficult == 3) {\n                $toBeAdded = false;\n            }\n\n            if ($request->has('filterPrepTime')) {\n                if ($request->get('maxPrepTime') != '' && $recipe->preparation_time > $request->get('maxPrepTime'))\n                    $toBeAdded = false;\n                if ($request->get('minPrepTime') != '' && $recipe->preparation_time < $request->get('minPrepTime'))\n                    $toBeAdded = false;\n            }\n\n            if ($request->has('filterCookTime')) {\n                if ($request->get('maxCookTime') != '' && $recipe->preparation_time > $request->get('maxPrepTime'))\n                    $toBeAdded = false;\n                if ($request->get('minCookTime') != '' && $recipe->preparation_time < $request->get('minPrepTime'))\n                    $toBeAdded = false;\n            }\n\n            // filter by tag\n            $recipe_tags = explode('_', $recipe->tags);\n\n            for ($tagnum = 1; $tagnum < 12; $tagnum++) {\n                if ($request->has('tag-' . $tagnum) && !in_array($tagnum, $recipe_tags)) {\n                    $toBeAdded = false;\n                }\n            }\n\n            if ($toBeAdded) {\n                array_push($id_recipes_ok, $recipe->id);\n            }\n\n        }\n\n        /*\n        $list_tags = array(\"First dish\",\"Main course\",\"Dessert\",\"Appetizer\", \"Side dish\" ,\"Meat\", \"Fish\", \"Vegetarian\", \"Vegan\", \"Gluten Free\", \"Without allergens\");\n        $numbers = array(\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\");\n        array_shift($_POST);\n\n        $element_key = array_keys($_POST);\n        $present_tag = array();\n        $present_ingredients = array();\n\n        if(count($_POST) == 0){\n            return Redirect::to(route('search_advanced_get',['array'=>json_encode(array())]));\n        }\n\n        if($element_key[0] == \"method__research__toggle\"){\n            array_shift($element_key);\n\n            foreach ($element_key as $item) {\n                $item = str_replace(\"_\", \" \", $item);\n                if (in_array($item, $list_tags)) {\n                    array_push($present_tag, $item);\n                } else {\n                    array_push($present_ingredients, $item);\n                }\n            }\n\n\n            $number_tag = str_replace($list_tags, $numbers, $present_tag);\n            $n_tag = count($number_tag);\n            $n_ing = count($present_ingredients);\n            echo $n_ing;\n            echo $n_tag;\n\n            echo \"<pre>\", print_r($element_key), \"</pre>\";\n\n\n            foreach ($recipes as $recipe) {\n                $tag_ok = 0;\n                $ing_ok = 0;\n\n                $recipe_ing = $recipe->ingredients_name;\n                $explode_ing = explode(\"_\", $recipe_ing);\n                array_shift($explode_ing);\n                $recipe_tag = $recipe->tags;\n                $explode_tag = explode(\"_\", $recipe_tag);\n                array_shift($explode_tag);\n\n                foreach ($explode_tag as $tag) {\n                    if (in_array($tag, $number_tag)) {\n                        $tag_ok++;\n                    }\n                }\n\n                foreach ($explode_ing as $item_ing) {\n                    if (in_array($item_ing, $present_ingredients)) {\n                        $ing_ok++;\n                    }\n                }\n\n                if($ing_ok==$n_ing && $tag_ok==$n_tag){\n                    array_push($id_recipes_ok, $recipe->id);\n                }\n\n            }\n\n            echo $tag_ok;\n            echo $ing_ok;\n        }\n        else {\n            foreach ($element_key as $item) {\n                $item = str_replace(\"_\", \" \", $item);\n                if (in_array($item, $list_tags)) {\n                    array_push($present_tag, $item);\n                } else {\n                    array_push($present_ingredients, $item);\n                }\n            }\n\n\n            $number_tag = str_replace($list_tags, $numbers, $present_tag);\n\n\n            foreach ($recipes as $recipe) {\n                $recipe_ing = $recipe->ingredients_name;\n                $explode_ing = explode(\"_\", $recipe_ing);\n                array_shift($explode_ing);\n                $recipe_tag = $recipe->tags;\n                $explode_tag = explode(\"_\", $recipe_tag);\n                array_shift($explode_tag);\n\n                foreach ($explode_tag as $tag) {\n                    if (in_array($tag, $number_tag)) {\n                        array_push($id_recipes_ok, $recipe->id);\n                    }\n                }\n\n                foreach ($explode_ing as $item_ing) {\n                    if (in_array($item_ing, $present_ingredients)) {\n                        array_push($id_recipes_ok, $recipe->id);\n                    }\n                }\n\n            }\n\n        }\n\n        */\n\n\n        $unique = array_unique($id_recipes_ok);\n        $ordered = array_values($unique);\n\n\n        return Redirect::to(route('search_advanced_get',['array'=>json_encode($ordered)]));\n\n    }\n\n    public function getSimpleSearchResult(Request $request){\n        session_start();\n        $dl = new DataLayer();\n\n        $id_recipes_ok = array();\n        $recipes_all = $dl->getAllRecipe();\n\n        $recipes = array();\n        foreach ($recipes_all as $recipe_ok) {\n            if($recipe_ok->approved == 1 || $recipe_ok->approved == 3){\n                array_push($recipes, $recipe_ok);\n            }\n        }\n\n        foreach ($recipes as $recipe) {\n\n            $toBeAdded = false;\n\n            if ( strpos($recipe->title, $request->get('text')) != false )\n                $toBeAdded = true;\n\n            if ($toBeAdded) {\n                array_push($id_recipes_ok, $recipe->id);\n            }\n\n        }\n\n        $unique = array_unique($id_recipes_ok);\n        $ordered = array_values($unique);\n\n\n        return Redirect::to(route('search_advanced_get',['array'=>json_encode($ordered)]));\n\n    }\n\n\n    public function acceptRecipe(Request $request){\n        $recipe_id = $request['recipe_id'];\n        $comment = $request['comment'];\n\n        session_start();\n        $dl = new DataLayer();\n        $dl->modifyApprovedRecipe(3, $recipe_id, $comment);\n\n        return null;\n    }\n\n\n    public function declineRecipe(Request $request){\n        $recipe_id = $request['recipe_id'];\n        $comment = $request->input('comment');\n        session_start();\n        $dl = new DataLayer();\n        $dl->modifyApprovedRecipe(2,$recipe_id, $comment);\n\n        return null;\n    }\n\n    public function correctRecipe(Request $request){\n        $recipe_id = $request['recipe_id'];\n\n        session_start();\n        $dl = new DataLayer();\n        $dl->modifyApprovedRecipe(1, $recipe_id,NULL);\n\n        return null;\n    }\n\n    public function reviewRecipe(Request $request){\n        $recipe_id = $request['recipe_id'];\n\n        session_start();\n        $dl = new DataLayer();\n        $dl->modifyApprovedRecipe(0, $recipe_id,NULL);\n\n        return null;\n    }\n}\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/Http/Controllers/RecipeController.php	(revision cc6d86fd1bc56e00f635b271c8f97d82614052bd)
+++ app/Http/Controllers/RecipeController.php	(date 1607611370640)
@@ -137,7 +137,7 @@
         if(isset($_SESSION['logged'])) {
 
             $user = $dl->getUserbyUsername($_SESSION['loggedName']);
-            if ($user->isModerator || $user->id == $rec->user_id) {
+            if ($user->isEditor || $user->id == $rec->user_id) {
                 if (isset($_POST['edit_form'])) {
 
 
